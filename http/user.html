<!--
SPDX-FileCopyrightText: 2025 maxhash.io <dev@maxhash.io>

SPDX-License-Identifier: AGPL-3.0-only
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light dark" />
    <link rel="stylesheet" href="/static/pico.min.css" />
    <title>User Statistics | maxhash.io Bitcoin Mining Pool</title>
    <meta
      name="description"
      content="View detailed Bitcoin mining statistics, hashrate, shares, and worker performance for your user account on maxhash.io."
    />
    <meta
      name="keywords"
      content="Bitcoin mining, mining pool, user statistics, hashrate, shares, workers, maxhash.io, solo mining"
    />
    <link rel="canonical" href="https://maxhash.io/user" />
    <meta property="og:title" content="User Statistics | maxhash.io Bitcoin Mining Pool" />
    <meta
      property="og:description"
      content="Check your Bitcoin mining user statistics, hashrate, shares, and worker details on maxhash.io."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://maxhash.io/user" />
    <meta property="og:site_name" content="maxhash.io" />

    <link rel="stylesheet" href="/static/styles.css" />
  </head>

  <body>
    <header class="container">
      <hgroup>
        <h1><a href="/">maxhash.io (beta)</a></h1>
        <p>A high performance Bitcoin solo mining pool</p>
      </hgroup>
      <nav>
        <ul>
          <li><a href="https://status.maxhash.io">Status</a></li>
        </ul>
      </nav>
    </header>

    <main class="container">
      <section>
        <h2>Summary</h2>

        <div class="overflow-auto" style="margin-top: 2em; margin-bottom: 1em">
          <span style="font-weight: bold; font-size: x-large">User <code id="username"></code></span>
        </div>

        <div id="user-stats">
          <span aria-busy="true">Loading user statistics...</span>
        </div>
      </section>

      <section>
        <h2>Workers</h2>
        <div id="worker-table" class="overflow-auto">
          <span aria-busy="true">Loading worker statistics...</span>
        </div>
      </section>
    </main>

    <footer class="container">
      <p>&copy; 2025 maxhash.io. All rights reserved.</p>
    </footer>

    <script defer>
      // Extract username from URL
      const pathParts = window.location.pathname.split("/");
      const username = decodeURIComponent(pathParts[pathParts.length - 1]);
      document.getElementById("username").textContent = username;

      // Fetch and display user statistics
      (async () => {
        try {
          const resp = await fetch(`/v1/users/${encodeURIComponent(username)}`);
          if (resp.status === 400 || resp.status === 404) {
            document.getElementById("user-stats").innerHTML = "<em>User not found.</em>";
            document.getElementById("worker-table").innerHTML = "<em>User not found.</em>";
            return;
          }
          if (!resp.ok) throw new Error("Failed to fetch user stats");

          const stats = await resp.json();

          // User stats
          document.getElementById("user-stats").innerHTML = `
            <div class="grid" style="grid-template-columns: repeat(3, 1fr);">
                <div class="grid-item"><strong>Hashrate (1m)</strong><br>${stats.hashrate1m}</div>
                <div class="grid-item"><strong>Hashrate (5m)</strong><br>${stats.hashrate5m}</div>
                <div class="grid-item"><strong>Hashrate (1hr)</strong><br>${stats.hashrate1hr}</div>
                <div class="grid-item"><strong>Hashrate (1d)</strong><br>${stats.hashrate1d}</div>
                <div class="grid-item"><strong>Hashrate (7d)</strong><br>${stats.hashrate7d}</div>
                <div class="grid-item"><strong>Shares</strong><br>${stats.shares}</div>
                <div class="grid-item"><strong>Best Share</strong><br>${stats.bestshare?.toFixed(8)}</div>
                <div class="grid-item"><strong>Best Ever</strong><br>${stats.bestever}</div>
                <div class="grid-item"><strong>Last Share</strong><br>${new Date(
                  stats.lastshare * 1000
                ).toLocaleString()}</div>
            </div>
            `;

          // Workers table
          if (stats.worker && stats.worker.length > 0) {
            document.getElementById("worker-table").innerHTML = `
              <table class="striped">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Hashrate (1m)</th>
                    <th>Hashrate (5m)</th>
                    <th>Hashrate (1hr)</th>
                    <th>Hashrate (1d)</th>
                    <th>Hashrate (7d)</th>
                    <th>Shares</th>
                    <th>Best Ever</th>
                    <th>Last Share</th>
                  </tr>
                </thead>
                <tbody>
                  ${stats.worker
                    .map(
                      (w) => `
                    <tr>
                      <td><code>${w.workername}</code></td>
                      <td>${w.hashrate1m}</td>
                      <td>${w.hashrate5m}</td>
                      <td>${w.hashrate1hr}</td>
                      <td>${w.hashrate1d}</td>
                      <td>${w.hashrate7d}</td>
                      <td>${w.shares}</td>
                      <td>${w.bestever}</td>
                      <td>${new Date(w.lastshare * 1000).toLocaleString()}</td>
                    </tr>
                  `
                    )
                    .join("")}
                </tbody>
              </table>
            `;
          } else {
            document.getElementById("worker-table").innerHTML = "<em>No workers found.</em>";
          }
        } catch {
          document.getElementById("user-stats").innerHTML = "<em>Failed to load user statistics.</em>";
          document.getElementById("worker-table").innerHTML = "<em>Failed to load worker statistics.</em>";
        }
      })();
    </script>
  </body>
</html>
